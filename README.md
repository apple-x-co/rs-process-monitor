# rs-process-monitor

é«˜é€Ÿã§ä½¿ã„ã‚„ã™ã„ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ãƒ„ãƒ¼ãƒ« - Rustè£½

## æ¦‚è¦

`rs-process-monitor` ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã®ãƒ—ãƒ­ã‚»ã‚¹ã¨ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚Apache/PHP-FPMãªã©ã®Webã‚µãƒ¼ãƒãƒ¼ã®ãƒ¡ãƒ¢ãƒªè¨­å®šã‚’æœ€é©åŒ–ã™ã‚‹éš›ã«ç‰¹ã«æœ‰ç”¨ã§ã™ã€‚

## ç‰¹å¾´

### ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±è¡¨ç¤º
- ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³ï¼ˆç·ãƒ¡ãƒ¢ãƒªãƒ»ä½¿ç”¨ç‡ãƒ»ç©ºãå®¹é‡ï¼‰
- ã‚¹ãƒ¯ãƒƒãƒ—ä½¿ç”¨çŠ¶æ³
- ãƒ—ãƒ­ã‚»ã‚¹çµ±è¨ˆï¼ˆãƒ—ãƒ­ã‚»ã‚¹æ•°ãƒ»åˆè¨ˆCPUãƒ»åˆè¨ˆãƒ¡ãƒ¢ãƒªï¼‰

### ğŸ“ˆ è©³ç´°ãªçµ±è¨ˆæƒ…å ±
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã® Min/Avg/Max è¡¨ç¤º
- ãƒ—ãƒ­ã‚»ã‚¹ã”ã¨ã® CPUä½¿ç”¨ç‡ãƒ»ãƒ¡ãƒ¢ãƒªãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
- è¤‡æ•°ã®ã‚½ãƒ¼ãƒˆæ–¹æ³•ï¼ˆMemory/CPU/PID/Nameï¼‰

### ğŸ¨ 2ã¤ã®è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰
- **é€šå¸¸ãƒ¢ãƒ¼ãƒ‰**: ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®è¦‹ã‚„ã™ã„å‡ºåŠ›
- **TUIãƒ¢ãƒ¼ãƒ‰**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è¡¨ç¤º

### ğŸ”§ å®Ÿç”¨çš„ãªæ©Ÿèƒ½
- ãƒ—ãƒ­ã‚»ã‚¹åã§ã®æ¤œç´¢ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰
- PIDæŒ‡å®šã§ã®è©³ç´°è¡¨ç¤º
- æœ€å°ãƒ¡ãƒ¢ãƒªãƒ•ã‚£ãƒ«ã‚¿ï¼ˆå°ã•ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’é™¤å¤–ï¼‰
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ï¼ˆä»»æ„ã®æ›´æ–°é–“éš”ï¼‰

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### ãƒ“ãƒ«ãƒ‰è¦ä»¶
- Rust 1.70ä»¥ä¸Š

### ãƒ“ãƒ«ãƒ‰æ‰‹é †

```bash
git clone https://github.com/apple-x-co/rs-process-monitor.git
cd rs-process-monitor
cargo build --release
```

ãƒã‚¤ãƒŠãƒªã¯ `target/release/rs-process-monitor` ã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

## ä½¿ã„æ–¹

### åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹

```bash
# è‡ªåˆ†è‡ªèº«ã®ãƒ—ãƒ­ã‚»ã‚¹æƒ…å ±ã‚’è¡¨ç¤º
rs-process-monitor

# ãƒ—ãƒ­ã‚»ã‚¹åã§æ¤œç´¢ï¼ˆä¾‹: Apacheï¼‰
rs-process-monitor --name httpd

# PIDã‚’æŒ‡å®šã—ã¦è¡¨ç¤º
rs-process-monitor --pid 1234

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã§ã‚½ãƒ¼ãƒˆï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
rs-process-monitor --name httpd --sort memory

# CPUä½¿ç”¨ç‡ã§ã‚½ãƒ¼ãƒˆ
rs-process-monitor --name httpd --sort cpu
```

### ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

```bash
# 10MBä»¥ä¸Šã®ãƒ—ãƒ­ã‚»ã‚¹ã®ã¿è¡¨ç¤ºï¼ˆè¦ªãƒ—ãƒ­ã‚»ã‚¹ã‚„å°ã•ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’é™¤å¤–ï¼‰
rs-process-monitor --name httpd --min-memory-mb 10

# æ­£å¸¸ãªãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹ã®ã¿ã‚’æŠ½å‡º
rs-process-monitor --name php-fpm --min-memory-mb 5
```

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–

```bash
# 2ç§’ã”ã¨ã«æ›´æ–°ï¼ˆé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ï¼‰
rs-process-monitor --name httpd --watch 2

# 1ç§’ã”ã¨ã«æ›´æ–°ï¼ˆTUIãƒ¢ãƒ¼ãƒ‰ï¼‰
rs-process-monitor --name httpd --watch 1 --tui

# CPUä½¿ç”¨ç‡ã§ã‚½ãƒ¼ãƒˆ + TUI
rs-process-monitor --name httpd --watch 2 --tui --sort cpu
```

### TUIãƒ¢ãƒ¼ãƒ‰ã®æ“ä½œ

- `q` ã¾ãŸã¯ `Esc`: çµ‚äº†

## å‡ºåŠ›ä¾‹

### é€šå¸¸ãƒ¢ãƒ¼ãƒ‰

```
=== System Information ===
System Memory: 397.27 MB / 769.15 MB (51.7% used, 371.88 MB available)
Swap: 901.81 MB / 5.00 GB (17.6% used)

=== Process Information ===
Processes matching 'httpd' (>= 11 MB) (sorted by Memory):
Total: 146 process(es)
Memory: 1.61 GB (Min: 11.02 MB, Avg: 11.27 MB, Max: 11.57 MB)
CPU: 0.00%

PID      Name                      CPU %    Memory       Status
---------------------------------------------------------------------------
3612234 httpd                     0.00     11.57 MB     Sleep
3612250 httpd                     0.00     11.57 MB     Sleep
...
```

### TUIãƒ¢ãƒ¼ãƒ‰

```
â”Œâ”€ System & Process Info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Process Monitor: 'httpd' (>= 11 MB) | Sort: Memory              â”‚
â”‚ System Memory: 397.27 MB / 769.15 MB (51.7% used, 371.88 MB ... â”‚
â”‚ Swap: 901.81 MB / 5.00 GB (17.6% used)                          â”‚
â”‚ Processes: 146 | CPU: 0.00%                                      â”‚
â”‚ Memory: 1.61 GB (Min: 11.02 MB, Avg: 11.27 MB, Max: 11.57 MB)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€ Processes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PID      Name                 CPU %    Memory       Status       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 3612234  httpd                0.00     11.57 MB     Sleep        â”‚
â”‚ 3612250  httpd                0.00     11.57 MB     Sleep        â”‚
â”‚ ...                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```
Options:
  -p, --pid <PID>
          ç›£è¦–ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã®PID

  -n, --name <NAME>
          ç›£è¦–ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹åï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰

  -w, --watch <WATCH>
          ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ï¼ˆæŒ‡å®šã—ãŸé–“éš”ã§æ›´æ–°ã€å˜ä½: ç§’ï¼‰

  -s, --sort <SORT>
          ã‚½ãƒ¼ãƒˆé †: memory (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ), cpu, pid, name
          [default: memory]

  -t, --tui
          TUIãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ï¼ˆ--watchã¨ä½µç”¨æ™‚ã®ã¿æœ‰åŠ¹ï¼‰

      --min-memory-mb <MIN_MEMORY_MB>
          æœ€å°ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã§ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆMBå˜ä½ã€æŒ‡å®šå€¤æœªæº€ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’é™¤å¤–ï¼‰

  -h, --help
          ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º

  -V, --version
          ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤º
```

## å®Ÿç”¨ä¾‹: Apache ã®ãƒ¡ãƒ¢ãƒªè¨­å®šæœ€é©åŒ–

### 1. ç¾åœ¨ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³ã‚’ç¢ºèª

```bash
rs-process-monitor --name httpd --min-memory-mb 10
```

å‡ºåŠ›ä¾‹:
```
System Memory: 397.27 MB / 769.15 MB (51.7% used, 371.88 MB available)
Memory: 1.61 GB (Min: 11.02 MB, Avg: 11.27 MB, Max: 11.57 MB)
```

### 2. MaxRequestWorkers ã®è¨ˆç®—

```
åˆ©ç”¨å¯èƒ½ãƒ¡ãƒ¢ãƒª: 769 MB
å®‰å…¨ãƒãƒ¼ã‚¸ãƒ³(20%): 769 MB Ã— 0.8 = 615 MB

MaxRequestWorkers = 615 MB / 11.57 MB â‰ˆ 53
â†’ æ¨å¥¨å€¤: 50
```

### 3. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ã§è² è·æ™‚ã®æŒ™å‹•ã‚’ç¢ºèª

```bash
rs-process-monitor --name httpd --watch 2 --tui --min-memory-mb 10 --sort memory
```

è² è·ã‚’ã‹ã‘ãŸæ™‚ã«ãƒ¡ãƒ¢ãƒªã® Max å€¤ãŒã©ã“ã¾ã§ä¸ŠãŒã‚‹ã‹ã‚’ç¢ºèªã€‚

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **è¨€èª**: Rust
- **ä¾å­˜ã‚¯ãƒ¬ãƒ¼ãƒˆ**:
    - `sysinfo` - ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±å–å¾—
    - `clap` - CLIå¼•æ•°ãƒ‘ãƒ¼ã‚¹
    - `ratatui` - TUIæ§‹ç¯‰
    - `crossterm` - ã‚¿ãƒ¼ãƒŸãƒŠãƒ«åˆ¶å¾¡
    - `chrono` - æ™‚åˆ»å‡¦ç†

## å¯¾å¿œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

- âœ… Linux (CentOS Stream 9, Ubuntu, Debian, etc.)
- âœ… macOS (é–‹ç™ºç’°å¢ƒ)
- âš ï¸ Windows (æœªãƒ†ã‚¹ãƒˆ)

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ä½œè€…

[@apple-x-co](https://github.com/apple-x-co)

## è²¢çŒ®

Issue ã‚„ Pull Request ã¯å¤§æ­“è¿ã§ã™ï¼

## é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

- [crt.sh API CLI](https://github.com/apple-x-co/Rs-crtsh-api)
- [PDF Generator CLI](https://github.com/apple-x-co/Rs-pdf-generator)
- [HTTP Request CLI](https://github.com/apple-x-co/Rs-http-request)
- [Log Analyzer](https://github.com/apple-x-co/Rs-log-analyzer)
- [CSV Validator](https://github.com/apple-x-co/Rs-csv-validator)
- [Mail Client CLI](https://github.com/apple-x-co/Rs-mail-client)
- [Image Compressor](https://github.com/apple-x-co/Rs-image-compressor)